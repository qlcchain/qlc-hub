syntax = "proto3";
package proto;
option go_package = ".;proto";

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";

message PingResponse {
   string nep5Address  =1;
   string erc20Address =2;
}

message DepositLockRequest{
   string nep5TxHash = 1;
   int64  amount     = 2;
   string rHash      = 3;
   string addr       = 4;
}

message DepositFetchNoticeRequest{
   string rHash      = 1;
   string nep5TxHash = 2;
}

message WithDrawUnlockRequest{
  string nep5TxHash = 1;
  string rOrigin    = 2;
}

message EventResponse {
  int64  state      = 1;
  string stateStr   = 2;
  string rHash      = 3;
  string txHash     = 4;
}

message StateInfo {
  int64  state        = 1;
  string stateStr     = 2;
  string rHash        = 3;
  string rOrigin      = 4;
  string lockedNep5Hash    = 5;
  string lockedErc20Hash   = 6;
  string unlockedNep5Hash  = 7;
  string unlockedErc20Hash = 8;
  int64  lockedHeight      = 9;
  int64  unlockedHeight    = 10;
}

service DepositAPI {
  rpc DepositLock(DepositLockRequest) returns (Boolean){
    option (google.api.http) = {
      post: "/deposit/lock"
      body: "*"
    };
  }

   rpc DepositFetchNotice(DepositFetchNoticeRequest) returns (Boolean){
       option (google.api.http) = {
           post: "/deposit/fetchNotice"
           body: "*"
        };
   }

   rpc DepositEvent(google.protobuf.Empty) returns (stream EventResponse){
      option (google.api.http) = {
         get: "/deposit/event"
      };
   }
}

service WithDrawAPI {
   rpc WithDrawUnlock(WithDrawUnlockRequest) returns (Boolean){
       option (google.api.http) = {
         post: "/withdraw/unlock"
         body: "*"
       };
    }

    rpc WithDrawEvent(google.protobuf.Empty) returns (stream EventResponse){
       option (google.api.http) = {
         get: "/withdraw/event"
       };
    }
}

service DebugAPI {
    rpc Ping(google.protobuf.Empty) returns (PingResponse){
        option (google.api.http) = {
          get: "/debug/ping"
        };
    }

    rpc HashState(String) returns (StateInfo){
        option (google.api.http) = {
          get: "/debug/state"
        };
    }
}


message Boolean {
    bool value = 1;
}

message String {
    string value = 1;
}
